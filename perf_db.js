// ==========================================
// ✈️ A330-300 (GE CF6) Advanced Physics DB v27.0 (OPT Logic Ready)
// ==========================================

window.perfDB = {
    // --------------------------------------
    // 1. 基準起飛速度 (Base V-Speeds) [KG]
    // --------------------------------------
    takeoff_speeds: [
        [130000, 122, 125, 130],
        [140000, 128, 132, 136],
        [150000, 133, 137, 141],
        [160000, 138, 142, 146],
        [170000, 143, 146, 151],
        [180000, 147, 150, 155],
        [190000, 151, 155, 159],
        [200000, 155, 159, 163],
        [210000, 159, 163, 168],
        [220000, 163, 167, 172],
        [230000, 166, 171, 176],
        [235000, 168, 173, 179],
        [242000, 170, 175, 181]
    ],

    // --------------------------------------
    // 2. 構型修正 (Config Correction)
    // --------------------------------------
    conf_correction: {
        "1+F": { v1: 0, vr: 0, v2: 0, dist_factor: 1.0 },    // 基準距離
        "2":   { v1: -3, vr: -3, v2: -2, dist_factor: 0.92 }, // 更短起飛距離 (更多升力)
        "3":   { v1: -6, vr: -6, v2: -5, dist_factor: 0.85 }  // 最短起飛距離
    },

    // --------------------------------------
    // 3. 降落速度表 [KG]
    // --------------------------------------
    landing_vls_full: [
        [130000, 122],
        [140000, 126],
        [150000, 130],
        [160000, 134],
        [170000, 138],
        [180000, 142],
        [190000, 146],
        [200000, 150],
        [210000, 154],
        [230000, 162]
    ],
    landing_conf3_add: 5, // Conf 3 Vapp 增加量

    // --------------------------------------
    // 4. 推力與環境物理 (Thrust Physics)
    // --------------------------------------
    flex_data: {
        base_temp: 46,       // Tref
        max_temp: 68,        // Max Flex allowed
        min_flex_margin: 0,  // Flex cannot be lower than OAT
        
        // Thrust Decay Model
        // 每一度 Flex 造成的推力損失 (換算為距離懲罰)
        flex_dist_penalty: 0.012, // 每增加1度Flex，距離增加 1.2%
    },

    // --------------------------------------
    // 5. 系統損耗
    // --------------------------------------
    bleed_penalty: {
        packs_on: 0.8,
        ai_eng: 0.5,
        ai_wing: 2.2
    },

    // --------------------------------------
    // 6. 跑道物理 (Runway Physics)
    // --------------------------------------
    runway_physics: {
        lua_full: 60,
        slope_v1_factor: 3.5,
        slope_dist_factor: 0.12, // 1% Slope 影響 12% 距離
        wet_brake_factor: 1.15,
        wet_toga_penalty: 0       // 濕地起飛距離懲罰 (Screen height 15ft vs 35ft offset)
    },

    // --------------------------------------
    // 7. Trim 模型
    // --------------------------------------
    trim_physics: {
        ref_cg: 29.0,
        step: 0.6,
        fuel_cg_effect: 0.00004, 
        deg_to_pct_factor: 8.0, 
        deg_to_pct_bias: 15.0
    },

    // --------------------------------------
    // 8. N1 引擎模型
    // --------------------------------------
    n1_physics: {
        base_n1: 98.2, // TOGA
        flex_correction: 0.22 
    },

    // --------------------------------------
    // 9. 距離估算模型 (Distance Calculation)
    // --------------------------------------
    dist_physics: {
        // 起飛基準: 200噸, 海平面, ISA, TOGA, Conf 1+F
        base_to_dist_ft: 5900,
        
        // 降落基準: 180噸, 海平面, ISA, CONF FULL, MAX BRAKE
        base_ld_dist_ft: 4920 
    },

    // --------------------------------------
    // [New] 10. 降落減速模型 (Deceleration)
    // --------------------------------------
    decel_physics: {
        // 相對於 MAX BRAKE 的距離係數
        autobrake: {
            "LO": 1.40,  // 距離最長
            "MED": 1.15,
            "MAX": 1.00  // 基準
        },
        conf3_penalty: 1.05, // Conf 3 雖然阻力小但地速快，且少一段 Flap 阻力
        rev_credit: {
            dry: 0.02, // 乾地反推影響小 (2%)
            wet: 0.08  // 濕地反推影響大 (8%)
        },
        safety_margin: {
            dry: 1.67, // 規章 RLD Dry
            wet: 1.92  // 規章 RLD Wet (+15%)
        }
    }
};
