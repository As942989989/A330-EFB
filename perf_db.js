// ==========================================
// ✈️ A330-300 (GE CF6) Advanced Physics DB v26
// ==========================================

window.perfDB = {
    // --------------------------------------
    // 1. 基準起飛速度 (Base V-Speeds) [KG]
    // --------------------------------------
    takeoff_speeds: [
        [130000, 122, 125, 130],
        [140000, 128, 132, 136],
        [150000, 133, 137, 141],
        [160000, 138, 142, 146],
        [170000, 143, 146, 151],
        [180000, 147, 150, 155],
        [190000, 151, 155, 159],
        [200000, 155, 159, 163],
        [210000, 159, 163, 168],
        [220000, 163, 167, 172],
        [230000, 166, 171, 176],
        [235000, 168, 173, 179],
        [242000, 170, 175, 181]
    ],

    // --------------------------------------
    // 2. 構型修正 (Config Correction)
    // --------------------------------------
    conf_correction: {
        "1+F": { v1: 0, vr: 0, v2: 0 },
        "2":   { v1: -3, vr: -3, v2: -2 },
        "3":   { v1: -6, vr: -6, v2: -5 }
    },

    // --------------------------------------
    // 3. 降落速度表 [KG]
    // --------------------------------------
    landing_vls_full: [
        [130000, 122],
        [140000, 126],
        [150000, 130],
        [160000, 134],
        [170000, 138],
        [180000, 142],
        [190000, 146],
        [200000, 150],
        [210000, 154],
        [230000, 162]
    ],
    landing_conf3_add: 4,

    // --------------------------------------
    // 4. 推力與環境物理 (Thrust Physics)
    // --------------------------------------
    flex_data: {
        base_temp: 46,
        max_temp: 68,
        mtow: 242000,
        slope_weight: 0.0006,
        slope_runway: 0.003,
        elev_penalty: 2.5,
        delta_t_penalty: 0.5,
        // [New] 物理修正係數
        t_ref: 30,           // Flat Rating 轉折溫度
        qnh_std: 1013,       // 標準氣壓
        qnh_effect: 0.05,    // 每 1hPa 對推力(Flex)的影響
    },

    // --------------------------------------
    // 5. 系統損耗 (Hidden System Bleed Penalties)
    // --------------------------------------
    bleed_penalty: {
        packs_on: 0.8,       // N1% 損失 (預設 ON)
        ai_eng: 0.5,         // N1% 損失
        ai_wing: 2.2         // N1% 損失 (Eng+Wing)
    },

    // --------------------------------------
    // 6. 跑道物理 (Runway Physics) - 核心修正
    // --------------------------------------
    runway_physics: {
        lua_full: 60,        // Line-Up Allowance (m)
        slope_v1_factor: 3.5,// 每 1% 下坡 V1 減少 (kt)
        slope_dist_factor: 0.10, // 每 1% 坡度對距離的影響 (10%)
        wet_brake_factor: 1.15,  // 濕滑跑道煞車距離係數 (+15%)
        rev_max_credit: 0.90     // Max Rev 濕地距離優惠 (90%)
    },

    // --------------------------------------
    // 7. Trim 模型
    // --------------------------------------
    trim_physics: {
        ref_cg: 29.0,
        step: 0.6,
        fuel_cg_effect: 0.00004, 
        deg_to_pct_factor: 8.0, 
        deg_to_pct_bias: 15.0
    },

    // --------------------------------------
    // 8. N1 引擎模型
    // --------------------------------------
    n1_physics: {
        base_n1: 98.2,       // TOGA N1
        flex_correction: 0.22 
    }
};
